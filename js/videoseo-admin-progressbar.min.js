function update_bar(a){a>100&&(a=99),a=Math.round(100*a)/100,jQuery(".bar","#video_seo_progressbar").css("width",a+"%"),jQuery("#video_seo_percentage_hidden").val(a),jQuery(".bar_status","#video_seo_progressbar").html(a>=5?a+"%":"&nbsp;")}function video_fetch(a){var b=parseInt(jQuery("#video_seo_total_posts").html()),c=jQuery("#video_seo_force_reindex").length,d={action:"index_posts",type:"index",start:a,total:b,portion:5,nonce:jQuery("#videoseo-nonce-ajax").val()};c>0&&(d.force="on"),jQuery.post(ajaxurl,d,function(c){b>a?(setTimeout(function(){video_fetch(a+5)},200),calculate_to_go(a,b,c)):(update_bar(100),jQuery("#video_seo_total_time").html("&nbsp;"),jQuery("#video_seo_done").show())});var e=b-a;0>e&&(e=0),jQuery("#video_seo_posts_to_go").html(e);var f=5/b*100,g=parseFloat(jQuery("#video_seo_percentage_hidden").val()),h=f+g;update_bar(h)}function calculate_to_go(a,b,c){var d=b-a,e=d/5,f=e*parseInt(c);jQuery("#video_seo_total_time").html(f==1/0?"Unknown":Math.round(f)+" seconds")}function get_total_posts(){update_bar(0);var a={action:"index_posts",type:"total_posts",nonce:jQuery("#videoseo-nonce-ajax").val()};jQuery.post(ajaxurl,a,function(a){var b=a;jQuery("#video_seo_total_posts").html(b),video_fetch(0)})}jQuery("#video_seo_done").hide(),setTimeout(function(){get_total_posts()},500);